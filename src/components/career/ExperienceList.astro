---
import { Icon } from "astro-icon/components"
import type { CollectionEntry } from "astro:content"
import TechTag from "./TechTag.astro"
import ProjectPeriod from "./ProjectPeriod.astro"

interface Props {
  items: CollectionEntry<"career">["data"]
  icon: string
}

const { items, icon } = Astro.props
---

<div class="experience-list">
  {
    items.map((item) => (
      <div class="experience-item">
        <Icon name={icon} aria-hidden="true" size="1rem" />
        <h3 class="experience-title">{item.title}</h3>
        <div class="experience-period">
          <ProjectPeriod start={item.start} end={item.end} />
        </div>
        <p>{item.detail}</p>
        <ul class="tech-list">
          {item.tech.map((tag) => (
            <li>
              <TechTag id={tag.id} />
            </li>
          ))}
        </ul>
      </div>
    ))
  }
</div>

<style>
  :where(h1, h2, h3, p) {
    margin: 0;
  }

  .experience-list {
    display: grid;
    gap: 0.5rem;
    padding-block: 1rem;
  }
  .experience-item {
    display: grid;
    grid-template-columns: 1rem 1fr;
    row-gap: 0.5rem;
    column-gap: 0.75rem;
    padding-block: 1rem;
    border-bottom: 1px dashed var(--slate-200);
  }
  .experience-item:first-of-type {
    padding-block-start: 0.25rem;
  }
  .experience-item:last-of-type {
    padding-block-end: 0;
    border-bottom: 0;
  }
  .experience-item > * {
    grid-column: 2;
  }
  .experience-item :global(svg) {
    grid-column: 1;
    align-self: center;
    color: var(--slate-400);
    overflow: visible;
  }
  .experience-title {
    line-height: 1.2;
  }
  .experience-period {
    font-family: "Lekton", "Noto Sans JP";
  }
  .tech-list {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
    margin: 0;
    list-style: none;
    padding: 0;
  }
</style>
