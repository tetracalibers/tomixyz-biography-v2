---
import WebGPUDemoLayout from "$/layouts/webgpu-demo.astro"
---

<WebGPUDemoLayout title="WebGPUアダプタが持つ情報の確認">
  <pre id="output"></pre>
</WebGPUDemoLayout>

<script>
  const adapter = await navigator.gpu.requestAdapter()
  if (!adapter) {
    throw new Error("WebGPU cannot be initialized - Adapter not found")
  }

  const limits = {}
  for (const key in adapter.limits) {
    // @ts-ignore
    const value = adapter.limits[key]
    if (typeof value === "number") {
      // @ts-ignore
      limits[key] = value
    }
  }

  const adapterInfo = {
    isFallbackAdapter: adapter.isFallbackAdapter,
    features: Array.from(adapter.features),
    limits
  }

  const $output = document.getElementById("output")
  $output!.textContent = JSON.stringify(adapterInfo, null, 2)
</script>
