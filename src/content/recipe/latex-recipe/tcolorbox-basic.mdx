---
title: tcolorboxによる独自枠の実装事始め
date: "2025-08-29"
description: todo
tags:
  - latex
  - tcolorbox
series: latex-recipe
references:
  - title: tcolorboxのお誘い
    url: https://marukunalufd0123.hatenablog.com/entry/2019/03/15/071717
  - title: tcolorboxの基本
    url: https://texmedicine.hatenadiary.jp/entry/2015/12/17/000339
#draft: true
---

LaTeXで数学ノートを作るにあたって、独自の囲み枠〜

## TikZとtcolorbox

LaTeXでは、[TikZ](https://tikz.dev/)という多機能な描画パッケージを利用することができます。（これが私がLaTeXをやめられない理由の一つです。）

TikZの機能を駆使すれば、どんな図版や装飾も基本的には実現可能でしょう。
しかし、あまりに多機能なので、すべての機能を把握する学習コストは高く、また、TikZで1から構築するのは面倒なものもやはりあります。

そこで、よく使われるユースケースについては、より簡単なコードで実現できるようなTikZ派生パッケージが世に多く存在しています。
その中でも、カスタマイズ可能な囲み枠を提供するパッケージが[tcolorbox](https://ctan.org/pkg/tcolorbox)です。

## tcolorboxを使う

プリアンブルに次のように書くことで、tcolorboxを使い始めることができます。

```latex
\usepackage{tcolorbox}
```

tcolorboxパッケージは、囲み枠付きでコンテンツを描画する`tcolorbox`環境を提供します。書式は次の通りです。

```latex
\begin{tcolorbox}[オプション]
  囲みたい内容
\end{tcolorbox}
```

オプションを何も指定しない場合は、デフォルトのスタイル（黒い枠線にグレーの背景）が適用されます。

```latex
\begin{tcolorbox}
  こんにちは世界
\end{tcolorbox}
```

- TODO: キャプチャ

オプションを指定することで、タイトルをつけたり、スタイルをカスタマイズしたりすることができます。

また、指定するオプションによっては、`tcolorbox`が提供するライブラリの読み込みが必要です。ライブラリの読み込みは、次のようにプリアンブルで指定します。

```latex
\usepackage{tcolorbox}
\tcbuselibrary{ライブラリ名}
```

この時点で、どんなオプションやライブラリがあるのか、どのようなことができるのか、探索してみたい方には次の記事をおすすめします。

- [tcolorboxの基本](https://texmedicine.hatenadiary.jp/entry/2015/12/17/000339)

このシリーズでは、さまざまな囲み枠の実例を取り上げる中で、必要なオプションやライブラリを都度紹介していきます。

## デフォルトスタイルのリセット

囲み枠をカスタマイズするときには、まずはデフォルトのスタイルを消してから、独自にスタイルを設定し直すことがよくあります。

（ここにbasic.texのキャプチャ）

### 余白を消す

`size=minimal`を指定することで、デフォルトの余白をすべて消すことができます。

```latex
\begin{tcolorbox}[size=minimal]
  こんにちは世界
\end{tcolorbox}
```

### 枠線や背景などの装飾を消す

枠線や背景色など、デフォルトの装飾をすべて消すには、`empty`オプションを指定します。

```latex
\begin{tcolorbox}[empty]
  こんにちは世界
\end{tcolorbox}
```

`empty`オプションを利用するには、プリアンブルで`skins`ライブラリの読み込みが必要です。

```latex
\tcbuselibrary{skins}
```

`skins`は描画方式を切り替えるためのライブラリであり、`empty`によって「何も描かない」描画方式に切りかえます。

## 独自の環境として定義する

同じオプションを指定した`tcolorbox`環境を複数箇所で使う場合、コピペして使い回していると、修正したくなったときに大変です。

tcolorboxでは、オプションを指定した囲み枠に名前をつけて、独自の環境として呼び出せるように定義することもできます。

```latex
\DeclareTColorBox{環境名}{引数}{%
  tcolorboxのオプション
}
```

文章の周りに余白を設けるだけの、シンプルな環境を定義してみましょう。

```latex
% \tcbuselibrary{skins} が必要

\DeclareTColorBox{spacebox}{}{%
  empty,
  beforeafter skip=\baselineskip
}
```

このように定義しておくと、`spacebox`環境として使い回しが可能になります。

```latex
（loremを囲むspaceboxのコード）
```

（単体のキャプチャ）

### 補足：ダミーテキストで表示確認

上のコード例で使用した`lipsum`コマンドは、ダミーテキストを出力するものです。

プリアンブルに次の指定を加えることで、`lipsum`コマンドが使えるようになります。

```latex
（usepackageのコード）
```

`lipsum`コマンドでは、引数指定によって生成する文章の長さを簡単に変えることができます。

- [LaTeX lipsum（追加版） --- Lorem Ipsumダミーテキストへの簡単なアクセス](https://konoyonohana.blog.fc2.com/blog-entry-566.html)

独自の囲み枠を実装するときには、さまざまな長さの文章で表示を確認してみるとよいでしょう。

短い文章では気にならなかった余白の狭さなどが、複数行になると目立つようなことはよくあります。また、ページをまたぐほど長い文章を入れたときの挙動はどうなるのか調べたい時など、文章の長さを変えながら表示を調整する際に`lipsum`コマンドを使うと便利です。

### 他の段落と調和させる

`beforeafter skip`は、ボックスの上下の外側余白をまとめて指定するオプションです。

ここでは、本文の行送り量 `\baselineskip` と同じだけ、上下に余白を設けています。

この指定により、ボックスとその前後の文章の間だけが特に狭くなることなく、ボックスもひとつの段落として、段落間の余白を統一することができます。

（指定なしの場合と指定ありの場合のキャプチャ）

## 引数で柔軟性を高める

この`spacebox`環境を使っていく中で、たとえば「文章を中央揃えしたい」箇所も出てくるかもしれません。

その場合は`spacebox`環境の中に`center`環境をネストすれば事足りますが、他にも「背景色をつけてより強調したい箇所」などが出てきたらどうでしょうか。
tcolorboxのオプションを追加で指定できるような仕組みがあると便利そうです。

`\DeclareTColorBox`では、引数を受け入れる環境を定義することができます。

tcolorboxのオプションを追加で指定できるようにするには、`spacebox`環境の定義を次のように修正します。

```latex
% \tcbuselibrary{skins} が必要

\DeclareTColorBox{spacebox}{O{}}{%
  empty,
  beforeafter skip=\baselineskip, #1
}
```

`O{}`という部分で、引数を追加しています。
`O`は、この引数は指定してもしなくてもいい（optional）であることを表し、`{}`の中には、引数が指定されなかった場合のデフォルト値を設定します。
ここでは`{}`の中身を空にしているので、引数が指定されなかった場合には何もしないという意味になります。

この引数設定の構文は、`xparse`パッケージに準ずるものです。他にもいろいろな引数の設定が可能なので、詳しくは次の記事などを参考にしてみてください。

- [xparse パッケージでスゴイ LaTeX マクロを作ろう！](https://qiita.com/zr_tex8r/items/50168ad7087516c3e139)

この引数として指定された内容は、`#1`で参照できます。引数としてtcolorboxのオプションが指定されたら、`empty`や`before after skip`に続けて、そのオプションを適用するようにしています。

このように定義した`spacebox`環境は、これまで通りそのままでも使えますし、引数を使ってtcolorboxのオプションを追加したり上書きしたりすることもできるようになります。

```latex
（そのままのコードと、valign=flush centerを指定した場合のコード）
```

（キャプチャ）

### 中央揃え（`flush`と`flush center`）

（違いを調べて書く）
